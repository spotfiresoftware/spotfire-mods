<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.128.1"><link rel="alternate" type="application/rss&#43;xml" href="/spotfire-mods/docs/action-mods/tutorial/index.xml">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon"  href="/spotfire-mods/favicons/favicon.ico" >


<title>Tutorial | Spotfire® Mods</title>
  <meta itemprop="name" content="Tutorial">
  <meta itemprop="description" content="Follow this tutorial to try out some examples of how to use the Spotfire Action Mods framework.">
  <meta itemprop="datePublished" content="2024-06-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-06-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1902">



<link rel="preload" href="/spotfire-mods/scss/main.min.b0e45692b242d6dff0bb1c57e0fa258091aef4e06f53aa9cab666f62cc2a1489.css" as="style">
<link href="/spotfire-mods/scss/main.min.b0e45692b242d6dff0bb1c57e0fa258091aef4e06f53aa9cab666f62cc2a1489.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>




    <title>Tutorial | Spotfire® Mods</title>
  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/spotfire-mods/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 232 40"><defs><style>.cls-1{fill:#333c66}.cls-1,.cls-2{stroke-width:0}.cls-2{fill:#e94165}</style></defs><g><path class="cls-1" d="m117.2 30.2h2.7c.1.0.2-.1.2-.2V16.1c0-.1-.1-.2-.2-.2h-2.6c-.1.0-.2.1-.2.2v14c-.1.1.0.1.1.1zm8.1-12.5v-1.6c0-.1-.1-.2-.2-.2h-2.6c-.1.0-.2.1-.2.2V30c0 .1.1.2.2.2h2.6c.1.0.2-.1.2-.2v-7.3c0-1.5.3-2.5.9-3.1s1.5-.9 2.7-.9h.6c.1.0.2-.1.2-.2v-2.7c0-.1-.1-.2-.2-.2-.9.0-1.7.2-2.4.6-.7.4-1.2.9-1.7 1.5.0.1-.1.0-.1.0h0zm-37.7.8c2.8.0 5 2.5 4.5 5.3-.3 1.8-1.8 3.2-3.6 3.5-3 .6-5.5-1.6-5.5-4.3.0-2.5 2.1-4.5 4.6-4.5m0-3c-4.5.0-8.1 3.8-7.6 8.3.4 3.4 3.2 6.2 6.7 6.6 4.6.5 8.5-3 8.5-7.4.0-4.1-3.4-7.4-7.6-7.5zm27.9-3.8V9.3c0-.1-.1-.2-.2-.2-2-.1-4.1.4-5.1 1.3-1.1 1-1.6 2.4-1.6 4.4v1.1h-2.4c-.1.0-.2.1-.2.2v2.4c0 .1.1.2.2.2h2.4V30c0 .1.1.2.2.2h2.7c.1.0.2-.1.2-.2V18.7h3.6c.1.0.2-.1.2-.2v-2.4c0-.1-.1-.2-.2-.2h-3.7v-1.1c0-2 1.5-2.9 3.6-2.8.2.0.3-.1.3-.3z"/><ellipse class="cls-1" cx="118.6" cy="10.9" rx="1.9" ry="1.8"/><path class="cls-1" d="m77.9 18.8c-.7-1.1-1.6-2-2.7-2.5s-2.3-.9-3.6-.9c-.5.0-1.1.1-1.6.2-.7.1-1.4.4-2 .7-.4.2-.7.4-1 .6q-.1.0-.1-.1v-1c0-.1-.1-.2-.2-.2H64c-.1.0-.2.1-.2.2v19.8c0 .1.1.2.2.2h2.6c.1.0.2-.1.2-.2V28c0-.1.1-.1.1.0.5.6 1.2 1.1 2 1.5.9.5 1.9.7 3 .7h.2c1.1-.1 2.1-.4 3-.9 1.1-.6 2-1.5 2.7-2.6s1-2.5 1-4-.2-2.8-.9-3.9h0zm-6.3 8.4c-2.4.0-4.4-2-4.4-4.5s2-4.5 4.4-4.5 4.4 2 4.4 4.5-2 4.5-4.4 4.5zm-11-6.3c-.8-.9-2-1.7-3.6-2.2l-2.1-.8c-2.1-.8-3.2-1.4-3.2-2.9s1.7-2.4 3.3-2.4c1 0 1.8.2 2.6.7.7.4 1.5.4 2.2.0l1.2-.8c.3-.2.3-.3.2-.4-1.5-1.6-3.7-2.6-6.1-2.6-1.9.0-3.6.5-4.8 1.5-1.3 1-1.9 2.5-1.9 4.2.0 2.7 1.5 4.5 4.9 5.7l2.3.8c2 .7 3 1.7 3 3.1.0 1.5-1.4 2.5-3.4 2.5-1.4.0-2.7-.5-3.7-1.3-.7-.6-1.7-.6-2.4-.1l-1 .7c-.3.2-.3.4-.2.5 1.4 2.1 4.1 3.4 7.2 3.4 2 0 3.7-.5 5-1.6 1.3-1 1.9-2.5 1.9-4.2-.1-1.6-.5-2.8-1.4-3.8zm43.9-2.2c.1.0.2-.1.2-.2v-2.4c0-.1-.1-.2-.2-.2h-3.7v-3.7c0-.1-.1-.2-.2-.2H98c-.1.0-.2.1-.2.2v3.7h-2.4c-.1.0-.2.1-.2.2v2.4c0 .1.1.2.2.2h2.4v7.5c0 1.4.4 2.5 1.1 3.1s1.8 1 3.2 1h2.5c.1.0.2-.1.2-.2V28c0-.1-.1-.2-.2-.2h-1.9c-.6.0-1.1-.1-1.3-.4s-.4-.6-.4-1.2v-7.5h3.5zm33.1 8.9c-1.2.0-2.2-.3-3-.9S133.2 25 133 24h11.3c.1.0.2-.1.2-.2.1-.4.1-.8.1-1.1.0-1.5-.4-2.5-1.1-3.9-.2-.4-.6-.8-.9-1.2-1.4-1.5-3.1-2.2-5.2-2.2s-4.1.7-5.5 2.1-2.1 3.2-2.1 5.3.7 3.9 2.2 5.3 3.4 2.1 5.7 2.1c2.5.0 4.4-.8 5.8-2.4.1-.1.1-.2.0-.3l-.7-.6c-.7-.6-1.7-.7-2.4-.2s-1.7.9-2.8.9zm-3.2-8.4c.8-.6 1.7-.9 2.9-.9 1 0 1.9.3 2.7.9s1.2 1.2 1.4 2.3v.1h-8.5c.2-1.1.7-1.7 1.5-2.4h0z"/></g><path class="cls-1" d="m146.4 13.4v.4h-.6v1.7h-.4v-1.7h-.6v-.4h1.6zm2 0h.4v2.1h-.4v-1.4l-.6 1-.6-1v1.4h-.4v-2.1h.4l.7 1.1.5-1.1h0z"/><path class="cls-1" d="m160.46 29.9V10.8h1.8V30h-1.8v-.1zm8.7-5.8-8.3-12.4.6-.5.7-.5 7.9 11.6-.9 1.8zm0 0-.8-1.8 7.8-11.6.7.5.6.5-8.3 12.4zm7.1 5.8V10.8h1.8V30h-1.8v-.1zm12.4.3c-1.3.0-2.5-.3-3.5-.9s-1.8-1.5-2.4-2.5c-.6-1.1-.9-2.3-.9-3.7s.3-2.6.8-3.7c.6-1.1 1.4-1.9 2.4-2.5s2.2-.9 3.5-.9 2.5.3 3.5.9 1.8 1.5 2.4 2.5c.6 1.1.8 2.3.8 3.7s-.3 2.6-.8 3.7-1.3 1.9-2.4 2.5c-.9.6-2.1.9-3.4.9h0zm0-1.5c1 0 1.9-.2 2.6-.7s1.3-1.1 1.8-2 .6-1.8.6-2.9-.2-2.1-.6-2.9c-.4-.8-1-1.5-1.8-2s-1.6-.7-2.6-.7-1.9.2-2.6.7c-.8.5-1.4 1.1-1.8 2-.4.8-.6 1.8-.6 2.9s.2 2.1.7 2.9c.4.8 1 1.5 1.8 2s1.5.7 2.5.7h0zm15.3 1.5c-1.2.0-2.3-.3-3.2-.9s-1.7-1.5-2.2-2.5c-.5-1.1-.8-2.3-.8-3.7s.3-2.6.8-3.7 1.3-1.9 2.2-2.5 2-.9 3.2-.9 2.2.3 3.1.9c.9.6 1.6 1.5 2.1 2.5.5 1.1.8 2.3.8 3.7s-.3 2.6-.8 3.7-1.2 1.9-2.1 2.5-1.9.9-3.1.9zm.3-1.4c.9.0 1.7-.2 2.3-.7.7-.5 1.2-1.2 1.6-2 .4-.9.6-1.8.6-3 0-1.1-.2-2.1-.6-3s-.9-1.5-1.6-2-1.5-.7-2.4-.7-1.8.2-2.5.7-1.3 1.2-1.7 2c-.4.9-.6 1.8-.6 3 0 1.1.2 2.1.6 3s1 1.5 1.7 2 1.7.7 2.6.7h0zm4.6 1.1-.1-2.5V10.8h1.6V30h-1.5v-.1zm10.3.3c-1 0-1.9-.2-2.7-.5-.7-.3-1.4-.7-1.8-1.2-.5-.5-.8-1-1-1.5l1.5-.5c.3.7.8 1.2 1.5 1.6s1.4.6 2.2.6c1 0 1.8-.2 2.5-.6s1-1 1-1.7-.2-1.2-.7-1.6-1.2-.8-2.2-1l-1.3-.4c-1.2-.3-2.2-.8-2.8-1.4s-1-1.3-1-2.1c0-1.3.4-2.2 1.2-2.9s2.1-1.1 3.8-1.1c.8.0 1.5.1 2.1.3s1.2.6 1.6 1 .8.9 1 1.5l-1.5.6c-.3-.7-.7-1.2-1.3-1.5s-1.3-.4-2.2-.4c-1 0-1.7.2-2.3.6s-.8 1-.8 1.7c0 .4.2.8.7 1.2s1.1.7 2 .9l1.2.3c.9.2 1.7.5 2.3.9s1.1.9 1.5 1.4.5 1.1.5 1.8c0 .8-.2 1.5-.6 2.1s-1 1-1.7 1.4c-.9.4-1.8.5-2.7.5z"/><g><path class="cls-1" d="m33.6 19.52-.02-.22-.03-.47-.06-.45c-.02-.15-.04-.3-.07-.45l-.08-.47c-.02-.08-.04-.17-.06-.26-.05-.21-.09-.42-.16-.63-.14-.52-.33-1.08-.62-1.75-.21-.49-.48-1.01-.85-1.64-.35-.57-.7-1.06-1.06-1.51-.8-.98-1.7-1.83-2.68-2.52-.17-.13-.35-.24-.53-.36-.08-.05-.16-.1-.24-.16-.08-.04-.17-.1-.26-.15-.18-.11-.35-.21-.53-.3-.48-.25-1.01-.49-1.69-.74-.52-.19-1.1-.35-1.77-.5l-.45-.08c-.16-.03-.3-.05-.45-.07l-.46-.06-.46-.03-.23-.02h-.22l-.46-.02h-.46l-.24.02-.22.02-.47.03-.45.06c-.15.02-.3.04-.45.07l-.46.08c-.66.15-1.24.31-1.76.5-.68.25-1.21.49-1.68.74-.19.09-.36.19-.54.3-.09.05-.18.11-.27.16-.07.05-.15.1-.23.15-.18.12-.36.23-.53.36-.99.69-1.89 1.54-2.69 2.52-.36.44-.71.94-1.06 1.51-.37.63-.63 1.15-.84 1.64-.28.67-.48 1.23-.61 1.74-.06.21-.11.42-.16.63-.02.09-.04.18-.06.27l-.08.45c-.03.16-.05.31-.07.45l-.06.47-.03.46-.02.23v.23l-.02.47v.46l.02.23.02.22.03.47.06.46c.02.15.04.29.07.45l.08.46c.02.08.04.17.06.25.05.22.1.43.16.63.14.52.33 1.08.62 1.75.21.49.48 1.01.85 1.64.35.57.7 1.06 1.06 1.51.8.98 1.7 1.83 2.68 2.52.17.13.34.24.52.35.08.05.17.11.25.16.08.04.17.1.26.15.18.11.35.21.53.29.48.26 1.01.49 1.69.74.37.13.72.24 1.07.34v-1.72c-.06-1.04-.58-2.01-1.43-2.66h-.01c-.15-.13-.28-.22-.39-.3-.11-.08-.21-.16-.31-.23l-.06-.05s-.03-.02-.05-.04c-.71-.49-1.37-1.12-1.97-1.85-.25-.31-.51-.68-.78-1.11-.25-.44-.45-.81-.62-1.21-.16-.39-.33-.82-.45-1.27-.04-.13-.07-.27-.1-.41-.02-.08-.03-.16-.05-.23l-.06-.34c-.02-.11-.04-.22-.05-.34l-.04-.32-.02-.35v-.16l-.02-.18v-.33-.35-.17l.02-.18.02-.33.05-.34c.01-.11.03-.23.05-.34l.06-.32c.02-.09.04-.17.06-.25.03-.14.06-.28.11-.42.11-.45.29-.89.44-1.26.18-.43.4-.83.62-1.2.28-.44.53-.79.78-1.11.6-.73 1.26-1.35 1.97-1.85.11-.09.23-.16.35-.24.07-.04.13-.09.2-.13h0v-.01c.07-.04.14-.08.21-.12.12-.07.24-.14.37-.2.42-.23.87-.41 1.22-.54.36-.13.76-.25 1.29-.37l.33-.06c.11-.02.22-.04.34-.05l.32-.04.34-.02h.16l.18-.02h.33.34.17l.18.02.33.02.34.05c.11.01.22.03.34.05l.32.06c.54.12.94.23 1.3.37.35.13.8.31 1.23.54.12.06.24.13.36.2.07.04.14.08.21.12h0v.01c.07.04.13.09.2.13.12.08.24.15.36.25.7.49 1.37 1.12 1.97 1.85.26.32.5.67.78 1.11.22.38.44.78.62 1.21.16.37.33.82.45 1.27.04.13.07.27.1.41.02.08.03.16.05.23l.06.34c.02.11.04.22.05.34l.04.32.02.34v.16l.02.18v.34.35.17l-.02.18-.02.33-.05.34c-.01.11-.03.23-.05.34l-.06.32c-.02.09-.04.17-.06.25-.03.14-.06.28-.11.42-.11.44-.28.87-.44 1.26-.17.4-.37.77-.62 1.2-.27.44-.53.8-.78 1.11-.6.73-1.26 1.35-1.97 1.85-.02.01-.03.03-.06.04l-.05.04c-.1.08-.2.15-.31.23-.11.08-.23.17-.38.29l-.02.02c-.84.65-1.36 1.62-1.43 2.66h0v1.71c.35-.09.7-.2 1.07-.34.67-.25 1.21-.48 1.68-.74.19-.09.36-.19.54-.3.09-.05.18-.11.27-.16.07-.05.15-.1.24-.15.18-.12.35-.23.52-.35.99-.7 1.89-1.54 2.69-2.52.36-.44.71-.94 1.06-1.51.37-.63.63-1.15.84-1.64.28-.67.48-1.23.61-1.74.06-.21.11-.42.16-.64.02-.09.04-.18.06-.26l.08-.45c.03-.16.05-.31.07-.45l.06-.47.03-.46.02-.24v-.22l.02-.47v-.46l-.02-.24z"/><ellipse class="cls-2" cx="20.15" cy="20" rx="5.21" ry="5.17"/><path class="cls-1" d="m20.15 3.65c4.41.0 8.56 1.7 11.68 4.8 3.11 3.09 4.82 7.19 4.82 11.55s-1.71 8.46-4.82 11.55c-3.12 3.09-7.26 4.8-11.68 4.8s-8.56-1.7-11.68-4.8C5.36 28.46 3.65 24.36 3.65 20s1.71-8.46 4.82-11.55c3.12-3.09 7.26-4.8 11.68-4.8m0-3.65C9.02.0.0 8.95.0 20s9.02 20 20.15 20S40.3 31.05 40.3 20 31.28.0 20.15.0h0z"/></g></svg></span><span class="text-uppercase font-weight-bold"></span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				<a class="nav-link" 
				href="/spotfire-mods/about/" 
				>
				<span>About</span></a>
				
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				<a class="nav-link active" 
				href="/spotfire-mods/docs/" 
				>
				<span class="active">Working with mods</span></a>
				
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				<span class="nav-link active hasChildren">
					<span  class="active">API documentation</span>
				</span>
				
				
				<ul class="navbar-subnav top">
					
					<li class="nav-item">
						<span class="active">Action mods</span>

						
						
						<ul class="navbar-subnav">
							
							<li class="nav-item">
								<a class="nav-link active" 
								href="/spotfire-mods/api-docs/action-mods/index.html" 
								>
								<span class="active">API documentation</span></a>
									</li>
							
						</ul>
						
		

					</li>
					
					<li class="nav-item">
						<span class="active">Visualization mods</span>

						
						
						<ul class="navbar-subnav">
							
							<li class="nav-item">
								<a class="nav-link active" 
								href="/spotfire-mods/overview/" 
								>
								<span class="active">API Overview</span></a>
									</li>
							
							<li class="nav-item">
								<a class="nav-link active" 
								href="/spotfire-mods/api-docs/visualization-mods/index.html" 
								>
								<span class="active">API documentation</span></a>
									</li>
							
						</ul>
						
		

					</li>
					
				</ul>
				
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center d-lg-none">
    

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Working with mods</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocs">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsgetting-started" href="/spotfire-mods/docs/getting-started/">Getting started</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Action mods</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocsaction-mods">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsaction-modsdeveloping-action-mods" href="/spotfire-mods/docs/action-mods/developing-action-mods/">Developing action mods</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/tutorial/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Tutorial</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocsaction-modstutorial">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/snippets/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Snippets</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsaction-modssnippets">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/using-the-api/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Using the API</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsaction-modsusing-the-api">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsaction-modsusing-the-apiapi-docs" href="/spotfire-mods/docs/action-mods/using-the-api/api-docs/">Action mods API documentation</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsaction-modsusing-the-apimod-schema" href="/spotfire-mods/docs/action-mods/using-the-api/mod-schema/">Mod Schema</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/faq/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">FAQ</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsaction-modsfaq">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Visualization mods</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-mods">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsdeveloping-visualization-mods" href="/spotfire-mods/docs/visualization-mods/developing-visualization-mods/">Developing visualization mods</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/tutorials/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-modstutorials">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modstutorialsbarchart-googlechart" href="/spotfire-mods/docs/visualization-mods/tutorials/barchart-googlechart/">Create a bar chart using Google Charts</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modstutorialsmod-icons" href="/spotfire-mods/docs/visualization-mods/tutorials/mod-icons/">Create an icon for your visualization mod</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/using-the-api/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Using the API</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-modsusing-the-api">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apiapi-overview" href="/spotfire-mods/docs/visualization-mods/using-the-api/api-overview/">API overview</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apiapi-docs" href="/spotfire-mods/docs/visualization-mods/using-the-api/api-docs/">Visualization mods API documentation</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apimod-data-views" href="/spotfire-mods/docs/visualization-mods/using-the-api/mod-data-views/">Mod data views</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apimod-schema" href="/spotfire-mods/docs/visualization-mods/using-the-api/mod-schema/">Mod schema</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apiworking-with-readables" href="/spotfire-mods/docs/visualization-mods/using-the-api/working-with-readables/">Mod reader</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/faq/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">FAQ</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-modsfaq">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsgetting-started-11" href="/spotfire-mods/docs/visualization-mods/getting-started-11/">Getting started (before 14.4)</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">












<a href="https://github.com/spotfiresoftware/spotfire-mods/issues/new?title=Tutorial" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/spotfiresoftware/spotfire-mods/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>





</div>






<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-initial-setup">1. Initial setup</a></li>
        <li><a href="#2-validate-our-development-environment">2. Validate our development environment</a></li>
        <li><a href="#3-set-up-document-properties">3. Set up document properties</a></li>
        <li><a href="#4-load-data-from-the-library">4. Load data from the library</a></li>
        <li><a href="#5-add-a-visualization">5. Add a visualization</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="/spotfire-mods/docs/">Working with mods</a>
</li>




<li class="breadcrumb-item" >
	<a href="/spotfire-mods/docs/action-mods/">Action mods</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/spotfire-mods/docs/action-mods/tutorial/">Tutorial</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	
	
	
	<p class="-text-secondary pt-3 h6" >Reading time: 8 minutes and 45 seconds.</p>
	<h1>Tutorial</h1>
	<div class="lead">Follow this tutorial to try out some examples of how to use the Spotfire Action Mods framework.</div>
	
	<h3 id="1-initial-setup">1. Initial setup</h3>
<ul>
<li>Create a folder called <code>setup-analysis</code> and open it in Visual Studio Code (VS Code).</li>
<li>Launch a terminal in VS Code and run <code>npx @spotfire/mods-sdk@latest new action</code> followed by <code>npm install</code>.</li>
<li>Launch the default build task (Ctrl+Shift+B).</li>
<li>Connect to the mod in Spotfire and click <em>Start debugging</em>.</li>
</ul>
<h3 id="2-validate-our-development-environment">2. Validate our development environment</h3>
<p>The first step is to make sure that we have a working development environment.
We want to make sure that mods can be debugged and that the executed script code is updated when we make changes.</p>
<ol>
<li>Go to the <em>Test</em> tab in the <em>Mods development</em> tool.</li>
<li>If script output is hidden, click <em>Show script output</em>.</li>
<li>To run the script:
<ol>
<li>Click <em>Test run</em>.</li>
<li>Click <em>Next</em> in the flyout that opens.</li>
<li>Give the configuration the name &ldquo;Test 1&rdquo;, so that we can re-use the configuration later.</li>
<li>For the message parameter, enter &ldquo;tutorial&rdquo;.</li>
<li>Click <em>Run</em>.</li>
</ol>
</li>
<li>&ldquo;tutorial!&rdquo; should now be printed in the script output.</li>
</ol>
<p>To check that we can debug the script, and that our local changes are picked up by Spotfire, do the following:</p>
<ol>
<li>
<p>Open <code>my-script.ts</code> in VS Code and prepend <code>&quot;Hello &quot;</code> to the message by changing line 8 to:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">message</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">addExclamationMark</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Hello &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">_message</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div></li>
<li>
<p>Put a breakpoint on line 8 by clicking the red dot to the left of the line number (visible when hovering).</p>
</li>
<li>
<p>Press <em>F5</em> and enter the debug port shown in the <em>Mods development</em> tool in Spotfire (default is 9222) to connect to the debugger.</p>
</li>
<li>
<p>Run the &ldquo;Test 1&rdquo; configuration.
VS Code should now be stuck on line 8, and Spotfire should be showing a progress dialog.
To inspect variables, you can hover over them. For example, hover over <code>_message</code> to see the message that was entered during configuration.</p>
<ul>
<li>Press F11 (Step into) to follow the code into the <code>addExclamationMark</code> function.</li>
<li>Press F10 (Step over) to jump to the next line.</li>
<li>Press F5 (Continue) to resume the script execution until finished or until reaching another breakpoint.</li>
</ul>
<p>For more information on what is possible to do when debugging in VS Code, refer to <a href="https://code.visualstudio.com/docs/editor/debugging">Debugging in Visual Studio Code</a>.</p>
</li>
<li>
<p>Resume execution of the script (press F5). &ldquo;Hello tutorial!&rdquo; should be visible in the script output.</p>
</li>
</ol>
<h3 id="3-set-up-document-properties">3. Set up document properties</h3>
<p>In Spotfire it is common to store analysis specific values in document properties.
We can create these properties using the APIs <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Data.DataProperty.html#CreateCustomPrototype">DataProperty.CreateCustomPrototype</a> to create a property object and <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Data.DataPropertyRegistry.html#AddProperty">DataPropertyRegistry.AddProperty</a> to add the object to the document.
The snippet <a href="/spotfire-mods/docs/action-mods/snippets/#set-a-document-property">&ldquo;Set a Document Property&rdquo;</a> shows how to set or create a document property parameterized by name, type, and value.
However, for the purposes of this tutorial, we will assume that we know what document properties to create, and that the script is running in a fresh analysis.</p>
<p>We will create the following document properties:</p>
<ul>
<li>a property to store the name of our company.</li>
<li>a property to store the date the analysis was created.</li>
</ul>
<p>Let&rsquo;s start by creating a new script by running <code>npx @spotfire/mods-sdk add-script setup-analysis --name &quot;Sets up the analysis&quot;</code>.
A file named <code>setup-analysis.ts</code> should now have been created, and the <code>mod-manifest.json</code> file have been updated with an entry for the script (remember to reload the manifest in the <em>Mods development</em> tool before you run the script). Open the file and change the code to look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Create shorthands for the relevant APIs.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">application</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetupAnalysisParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Check if the property already exists.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ContainsProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;companyName&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Create the property object.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;companyName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">String</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Set the property value.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Tutorial Company&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Add it to the document.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>If you run this script, a document property with the name &ldquo;companyName&rdquo; will be created.
The code for creating the second property will be pretty much identical except the property name, type, and initial value will be different.
We can re-use this code by creating a function within the script closure which is parameterized by name and type.
The <code>setupAnalysis</code> function should now look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Create shorthands for the relevant APIs.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">application</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetupAnalysisParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;companyName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">String</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Tutorial Company&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;creationDate&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Now</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span>: <span style="color:#204a87;font-weight:bold">unknown</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Check if the property already exists.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ContainsProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Create the property object.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Set the property value.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Add it to the document.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>If we wanted to re-use the <code>addProperty</code> function across multiple scripts in the action mod, we could move it to the <code>utils.ts</code> file and import it in the same way that <code>addExclamationMark</code> is imported in <code>my-script.ts</code>.
Moving the function would require adding a <code>document</code> parameter with type <code>Spotfire.Dxp.Application.Document</code> to the function.</p>
<h3 id="4-load-data-from-the-library">4. Load data from the library</h3>
<p>Spotfire has APIs for interacting with the library, such as saving the analysis to the library via <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Application.AnalysisApplication.html#SaveAs">AnalysisApplication.SaveAs</a> and <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Application.AnalysisApplication.html#SaveCopy">AnalysisApplication.SaveCopy</a>, or exporting a data table to the library via <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Data.DataTable.html#ExportDataToLibrary">DataTable.ExportDataToLibrary</a>.
These APIs generally take or return a <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Framework.Library.LibraryItem.html">LibraryItem</a> representing the entry in the library.
Each item is uniquely defined by an ID, known as a <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">GUID</a>.
We can retrieve the relevant <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Framework.Library.LibraryItem.html">LibraryItem</a> from a GUID via the <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Framework.Library.LibraryManager-1.html#TryGetItem">LibraryManager.TryGetItem</a> method, or by searching for the item via <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Framework.Library.LibraryManager-1.html#Search">LibraryManager.Search</a>.</p>
<p>If you do not have an SBDF file saved to the library, you can simply export the currently loaded data to the library.
We will assume that the SBDF file is named &ldquo;my-data&rdquo; in the rest of the tutorial.
Try to search for the item in the library by updating <code>setup-analysis.ts</code> to look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Create shorthands for the relevant APIs.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">application</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetupAnalysisParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;companyName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">String</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Tutorial Company&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;creationDate&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Now</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Retrieve the library manager service and assume it is defined since we are connected to a TSS.
</span></span></span><span style="display:flex; background-color:#dfdfdf"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">libraryManager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Search</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;type::sbdf my-data&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IncludePath</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">result</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">results</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Found item: Title=</span><span style="color:#4e9a06">${</span><span style="color:#000">result</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">, Path=</span><span style="color:#4e9a06">${</span><span style="color:#000">result</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Path</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">, GUID=</span><span style="color:#4e9a06">${</span><span style="color:#000">result</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Id</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ToString</span><span style="color:#000;font-weight:bold">()</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span>: <span style="color:#204a87;font-weight:bold">unknown</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ContainsProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Create a the property object
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Set the property value.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Add it to the document
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>Running this script will result in an error that looks something like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Could not run action
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The API function &#39;LibraryItemRetrievalOption.get_IncludePath&#39; requires &#39;LibraryRead&#39; to be specified in the &#34;capabilities&#34; property of the manifest file.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: The property get method is unavailable or inaccessible
</span></span><span style="display:flex;"><span>    at setupAnalysis (C:\setup-analysis\build\setup-analysis.js:10:92) -&gt;     const results = libraryManager.Search(&#34;type::sbdf my-data&#34;, LibraryItemRetrievalOption.IncludePath);
</span></span></code></pre></div><p>The error indicates that we need to declare in the mod manifest that we intend to interact with the library.
Action mods are designed to be safe to use, and require that the mod declares when it wants to use APIs that interact with systems outside the current analysis.
This declaration is known as a capability of the mod, and will show up in trust dialogs when the user is asked to trust the mod. For more information, see <a href="/spotfire-mods/docs/action-mods/faq/#what-are-capabilities">&ldquo;What are capabilities?&rdquo;</a>.</p>
<p>Update the <code>mod-manifest.json</code> file by adding <code>&quot;LibraryRead&quot;</code> to the <code>&quot;capabilities&quot;</code> array.
Making changes to the manifest file requires reloading of the mod, which can be done by clicking <em>Reload manifest</em> in the <em>Mods development</em> tool.
If you run the script again, the debug output should now display a search result for the SBDF file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Found item: Title=my-data, Path=/my-data, GUID=a82c6a33-2743-492d-870b-8c188f8cc66b
</span></span></code></pre></div><p>Now that our search results in a match, we can update the script to load data. One option is to use the search result:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">myDataItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">results</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#34;my-data&#34;</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ItemType</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SbdfDataFile</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>Another option is to use the GUID (this method uses an output parameters, see <a href="/spotfire-mods/docs/action-mods/faq/#how-do-i-use-apis-with-output-parameters">&ldquo;How do I use APIs with output parameters?&rdquo;</a> for more info):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">myDataItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">LibraryItem</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Guid</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;a82c6a33-2743-492d-870b-8c188f8cc66b&#34;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">myDataItem</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>Using the library item we can load the data into the analysis using the <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Data.Import.SbdfLibraryDataSource.html">SbdfLibraryDataSource</a> and <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Data.DataTableCollection.html#Add">DataTableCollection.Add</a> APIs:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">sbdfDataSource</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SbdfLibraryDataSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">myDataItem</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sbdfDataSource</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><p>Similarily to the <code>addProperty</code> function, we can move this logic out into a separate function in case we want to re-use the logic with a different library item in the future.</p>
<p>With the option using the search result, the script <code>setup-analysis.ts</code> should now look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Create shorthands for the relevant APIs.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">SbdfLibraryDataSource</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Import</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemType</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">application</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetupAnalysisParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;companyName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">String</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Tutorial Company&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;creationDate&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Now</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">loadLibraryData</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;my-data&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">loadLibraryData</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Contains</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Item</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Retrieve the library manager service and assume it is defined since we are connected to a TSS.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">libraryManager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Search</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`type::sbdf </span><span style="color:#4e9a06">${</span><span style="color:#000">tableName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IncludePath</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">myDataItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">results</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#34;my-data&#34;</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ItemType</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SbdfDataFile</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">myDataItem</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Found no SBDF in the library with the name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">tableName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Load the data.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">sbdfDataSource</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SbdfLibraryDataSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">myDataItem</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sbdfDataSource</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span>: <span style="color:#204a87;font-weight:bold">unknown</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ContainsProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Create a the property object
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Set the property value.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Add it to the document
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h3 id="5-add-a-visualization">5. Add a visualization</h3>
<p>Let&rsquo;s finish this tutorial off by adding a visualization to the current page, and configure it to use the data we loaded from the library.
Visualizations can be added to a page via the <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Application.VisualCollection.html#AddNew">VisualCollection.AddNew</a> API.
We will modify <code>loadLibraryData</code> slightly, to return a reference to the data table, and then set it as the <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Application.Visuals.VisualizationData.html#DataTableReference">VisualizationData.DataTableReference</a> for our newly created bar chart visualization.
After setting the data table reference <a href="/spotfire-mods/api-docs/action-mods/classes/Spotfire.Dxp.Application.Visual.html#AutoConfigure">Visual.AutoConfigure</a> can be used to automatically set up the axis, after which we will change the bar chart to be horizontal and colored by the X-axis expression.
The script <code>setup-analysis.ts</code> should now look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Create shorthands for the relevant APIs.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">SbdfLibraryDataSource</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Import</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemType</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">VisualTypeIdentifiers</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">BarChartOrientation</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">application</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetupAnalysisParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;companyName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">String</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Tutorial Company&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;creationDate&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Now</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">myDataTable</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">loadLibraryData</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;my-data&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">let</span> <span style="color:#000">page</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ActivePageReference</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">page</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>        <span style="color:#8f5902;font-style:italic">// No pages exist, add one.
</span></span></span><span style="display:flex; background-color:#dfdfdf"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">page</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Pages</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddNew</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">barChart</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddNew</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">VisualTypeIdentifiers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">As</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Tutorial Visualization&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataTableReference</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">myDataTable</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#8f5902;font-style:italic">// Use AutoConfigure to setup axis.
</span></span></span><span style="display:flex; background-color:#dfdfdf"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AutoConfigure</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Orientation</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">BarChartOrientation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Horizontal</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex; background-color:#dfdfdf"><span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColorAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Expression</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">XAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Expression</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">loadLibraryData</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Contains</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Item</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Retrieve the library manager service and assume it is defined since we are connected to a TSS.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">libraryManager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">results</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Search</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`type::sbdf </span><span style="color:#4e9a06">${</span><span style="color:#000">tableName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IncludePath</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">myDataItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">results</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">find</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#34;my-data&#34;</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ItemType</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SbdfDataFile</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">myDataItem</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Found no SBDF in the library with the name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">tableName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Load the data.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">sbdfDataSource</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SbdfLibraryDataSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">myDataItem</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tableName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sbdfDataSource</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span>: <span style="color:#204a87;font-weight:bold">unknown</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ContainsProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Create a the property object
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Set the property value.
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Add it to the document
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setupAnalysis</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div>
        






	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified June 5, 2024
</div>
</div>

          </main>
        </div>
      </div>
      
<footer class="bg-dark py-4 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the official Spotfire page on X" aria-label="Open the official Spotfire page on X">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://x.com/spotfire">
      <i class="fab fa-x-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the official Spotfire page on LinkedIn" aria-label="Open the official Spotfire page on LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/spotfire/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the Dr. Spotfire YouTube channel" aria-label="Open the Dr. Spotfire YouTube channel">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/@drspotfire">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the Facebook group for Spotfire users, partners, and practitioners" aria-label="Open the Facebook group for Spotfire users, partners, and practitioners">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/groups/651751391967838">
      <i class="fab fa-facebook"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the Spotfire user group on LinkedIn" aria-label="Open the Spotfire user group on LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/12253057/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/spotfiresoftware/spotfire-mods">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Spotfire Community" aria-label="Spotfire Community">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://spotfi.re/community/mods-overview">
      <i class="fa fa-comment-alt"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 Cloud Software Group All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.cloud.com/privacy-policy" target="_blank">Privacy Policy</a></small>
	
		<p class="mt-2"><a href="/spotfire-mods/about/">About Spotfire Mods</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/spotfire-mods/js/main.min.2e372965989862d7e055760988f44f8141d8237a114d3737f4f38d503db9494b.js" data-integrity="sha256-LjcpZZiYYtfgVXYJiPRPgUHYI3oRTTc39PONUD25SUs=" crossorigin="anonymous"></script>




  </body>
</html>