<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.76.4" /><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon"  href="/spotfire-mods/favicons/favicon.ico" >


<title>Create a bar chart using Google Charts | Spotfire® Mods</title><meta property="og:title" content="Create a bar chart using Google Charts" />
<meta property="og:description" content="This tutorial describes how to create a basic bar chart using Google Charts and the Spotfire API.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/spotfire-mods/docs/tutorials/barchart-googlechart/" />
<meta property="article:published_time" content="2020-11-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-11-06T00:00:00+00:00" /><meta property="og:site_name" content="Spotfire® Mods" />
<meta itemprop="name" content="Create a bar chart using Google Charts">
<meta itemprop="description" content="This tutorial describes how to create a basic bar chart using Google Charts and the Spotfire API.
">
<meta itemprop="datePublished" content="2020-11-06T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-11-06T00:00:00+00:00" />
<meta itemprop="wordCount" content="2472">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Create a bar chart using Google Charts"/>
<meta name="twitter:description" content="This tutorial describes how to create a basic bar chart using Google Charts and the Spotfire API.
"/>





<link rel="preload" href="/spotfire-mods/scss/main.min.4c0876a5047f52f890950d4c0e413f53fa251e7d913cd2e6f0bf3cd510821323.css" as="style">
<link href="/spotfire-mods/scss/main.min.4c0876a5047f52f890950d4c0e413f53fa251e7d913cd2e6f0bf3cd510821323.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>




    <title>Create a bar chart using Google Charts | Spotfire® Mods</title>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/spotfire-mods/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 260 26"><polygon points="0 2.142 0 4.631 6.756 4.631 6.756 21.582 9.347 21.582 9.347 4.631 16.103 4.631 16.103 2.142 0 2.142" style="fill:#fff"/><rect x="19.187" y="2.142" width="2.592" height="19.44" style="fill:#fff"/><path d="M36.147 11.567c2.16-.809 3.3-2.271 3.3-4.262.0-3.048-2.066-5.163-6.725-5.163H26.337v19.44h6.571c4.967.0 7.157-2.208 7.157-5.5C40.065 13.9 38.708 12.22 36.147 11.567zm-7.188-7h3.98c2.53.0 3.887 1.089 3.887 2.955.0 1.9-1.512 3.142-4.288 3.142H28.959zm4.2 14.589h-4.2v-6.1h3.795c2.715.0 4.689.808 4.689 3.048C37.443 18.13 36.024 19.157 33.155 19.157z" style="fill:#fff"/><path d="M51.947 19.685c-4.226.0-7.065-3.08-7.065-7.9s2.808-7.745 7-7.745A8.985 8.985.0 0157.16 5.688l.833-2.395a12.063 12.063.0 00-6.108-1.618c-5.614.0-9.656 4.044-9.656 10.234s4.011 10.14 9.656 10.14a11.586 11.586.0 005.954-1.617l-.432-2.644A9.259 9.259.0 0151.947 19.685z" style="fill:#fff"/><path d="M72.987 2.562c-2.52 4.872-7.1 10.667-13.159 13.964a9.246 9.246.0 001.314 2.139A40.1 40.1.0 0073.879 3.047 8.9 8.9.0 0072.987 2.562z" style="fill:#fff"/><path d="M68.57 1.618c-5.668.0-9.672 4.41-9.672 10.218a12.52 12.52.0 00.3 2.765c5.8-2.383 10.95-7.636 13.562-12.143A10.369 10.369.0 0068.57 1.618z" style="fill:#fff"/><path d="M74.1 3.184A47.341 47.341.0 0162.87 20.264a9.823 9.823.0 005.7 1.7c5.668.0 9.671-4.442 9.671-10.25C78.241 7.863 76.661 4.878 74.1 3.184z" style="fill:#fff"/><path d="M188.584.0a2.514 2.514.0 00-2.49 2.525V2.54a2.49 2.49.0 104.979-.015V2.511A2.493 2.493.0 00188.584.0zm2.2 2.525a2.2 2.2.0 11-4.407.015V2.525a2.2 2.2.0 114.407-.014zm-1.059-.52c0-.533-.414-.807-.973-.807H187.61V3.751h.487v-.88h.53l.6.88h.586l-.673-.966A.768.768.0 00189.728 2.005zm-1.015.462H188.1V1.631h.616c.329.0.515.144.515.418C189.228 2.294 189.042 2.467 188.713 2.467z" style="fill:#fff"/><polygon points="212.126 2.128 204.004 13.953 195.856 2.128 194.975 2.128 194.975 21.558 195.883 21.558 195.883 3.765 203.95 15.424 204.004 15.424 212.071 3.765 212.071 21.558 213.007 21.558 213.007 2.128 212.126 2.128" style="fill:#fff"/><path d="M223.551 7.235a7.174 7.174.0 00-7.213 7.328v.056a7.186 7.186.0 1014.371-.056v-.055A7.1 7.1.0 00223.551 7.235zm6.222 7.356a6.24 6.24.0 11-12.472.0v-.056A6.212 6.212.0 01223.5 8.068a6.315 6.315.0 016.278 6.467z" style="fill:#fff"/><path d="M245.822 1.3V11.371a6.47 6.47.0 00-6.139-4.136 6.981 6.981.0 00-6.855 7.3v.056a6.965 6.965.0 006.855 7.3 6.532 6.532.0 006.139-4.192v3.858h.881V1.3zm.055 13.3a6.225 6.225.0 01-6.111 6.44c-3.442.0-6-2.776-6-6.468v-.055c0-3.748 2.5-6.412 6-6.412a6.242 6.242.0 016.111 6.439z" style="fill:#fff"/><path d="M255.182 13.98c-2.257-.638-4.212-1.277-4.212-3.025V10.9c0-1.554 1.514-2.748 3.8-2.748a7.831 7.831.0 014.4 1.471l.5-.749A8.96 8.96.0 00254.8 7.318c-2.836.0-4.735 1.583-4.735 3.664v.056c0 2.332 2.23 3.053 4.817 3.8 2.12.583 4.213 1.194 4.213 3.164v.056c0 1.721-1.735 2.914-3.965 2.914a8.474 8.474.0 01-5.176-1.915l-.523.694a9.1 9.1.0 005.644 2.054c2.781.0 4.928-1.527 4.928-3.83v-.056C260 15.479 257.715 14.674 255.182 13.98z" style="fill:#fff"/><path d="M94.3 10.788c-4.239-.916-5.231-1.943-5.231-3.775V6.957c0-1.748 1.6-3.136 4.1-3.136A8.425 8.425.0 0198.73 5.93L1e2 4.237A10 10 0 0093.223 1.85c-3.661.0-6.332 2.248-6.332 5.3v.055c0 3.193 2.038 4.636 6.47 5.608 4.047.86 5.011 1.887 5.011 3.691v.056c0 1.915-1.707 3.3-4.3 3.3a9.139 9.139.0 01-6.607-2.748l-1.349 1.61A11.224 11.224.0 0094 21.836c3.826.0 6.579-2.165 6.579-5.5v-.056C100.574 13.314 98.592 11.732 94.3 10.788z" style="fill:#fff"/><path d="M111.117 6.9a6.392 6.392.0 00-5.451 3.192V7.207h-2.12V26h2.12V18.81a6.411 6.411.0 005.451 3.054c3.442.0 6.8-2.776 6.8-7.467v-.056C117.917 9.622 114.531 6.9 111.117 6.9zm4.625 7.522c0 3.47-2.257 5.524-5.01 5.524a5.321 5.321.0 01-5.149-5.551v-.056a5.332 5.332.0 015.149-5.524c2.7.0 5.01 2.165 5.01 5.552z" style="fill:#fff"/><path d="M127.276 6.9a7.4 7.4.0 00-7.433 7.5v.055a7.323 7.323.0 007.378 7.44 7.422 7.422.0 007.461-7.495v-.056A7.346 7.346.0 00127.276 6.9zm5.231 7.55a5.276 5.276.0 01-5.231 5.524 5.364 5.364.0 01-5.258-5.579v-.056a5.279 5.279.0 015.2-5.552 5.412 5.412.0 015.286 5.608z" style="fill:#fff"/><path d="M144.784 9.1V7.207h-4.515V2.877h-2.12v4.33h-1.982V9.1h1.982v8.66c0 2.915 1.734 4.053 4.019 4.053a5.3 5.3.0 002.561-.611V19.366a4.427 4.427.0 01-2.065.5 2.114 2.114.0 01-2.395-2.387V9.1z" style="fill:#fff"/><path d="M152.794 3.044a7.024 7.024.0 012.064.36V1.545a6.384 6.384.0 00-2.34-.361 4.167 4.167.0 00-3.055 1.11 5.087 5.087.0 00-1.239 3.692V7.235h-1.955V9.1h1.955V21.558h2.12V9.1h4.487V7.263h-4.515V6.1C150.316 4.043 151.142 3.044 152.794 3.044z" style="fill:#fff"/><rect x="157.584" y="1.711" width="2.423" height="2.359" style="fill:#fff"/><rect x="157.75" y="7.207" width="2.092" height="14.351" style="fill:#fff"/><path d="M165.814 10.955V7.207h-2.12V21.558h2.12V15.84c0-4.33 2.533-6.578 5.644-6.578h.165V6.957A6.1 6.1.0 00165.814 10.955z" style="fill:#fff"/><path d="M185.719 14.508c0-4.219-2.423-7.606-6.635-7.606-3.937.0-6.827 3.331-6.827 7.5a7.113 7.113.0 007.1 7.495 7.326 7.326.0 005.865-2.693L183.9 18.005a5.869 5.869.0 01-4.487 2.027 4.991 4.991.0 01-5.011-4.775h11.287C185.719 14.924 185.719 14.7 185.719 14.508zM174.4 13.536c.3-2.776 2.175-4.83 4.625-4.83 2.808.0 4.3 2.221 4.542 4.83z" style="fill:#fff"/><path d="M81.876 2.005c0-.533-.415-.807-.973-.807H79.758V3.751h.486v-.88h.53l.6.88h.587l-.673-.966A.768.768.0 0081.876 2.005zm-1.016.462h-.616V1.631h.616c.329.0.515.144.515.418C81.375 2.294 81.189 2.467 80.86 2.467zM80.731.0a2.514 2.514.0 00-2.49 2.525V2.54a2.49 2.49.0 104.98-.015V2.511A2.493 2.493.0 0080.731.0zm2.2 2.525a2.2 2.2.0 11-4.408.015V2.525a2.2 2.2.0 114.408-.014z" style="fill:#fff"/></svg></span><span class="text-uppercase font-weight-bold"></span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/spotfire-mods/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link active" href="/spotfire-mods/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/spotfire-mods/overview/" ><span>API Overview</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a class="nav-link" href="/spotfire-mods/api-docs/index.html" ><span>API Documentation</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center d-lg-none">
    

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocs">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsgetting-started" href="/spotfire-mods/docs/getting-started/">Getting started</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/using-the-api/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Using the API</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsusing-the-api">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsusing-the-apiapi-overview" href="/spotfire-mods/docs/using-the-api/api-overview/">API overview</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsusing-the-apiapi-docs" href="/spotfire-mods/docs/using-the-api/api-docs/">API documentation</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsusing-the-apimod-data-views" href="/spotfire-mods/docs/using-the-api/mod-data-views/">Mod data views</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsusing-the-apimod-schema" href="/spotfire-mods/docs/using-the-api/mod-schema/">Mod schema</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsusing-the-apiworking-with-readables" href="/spotfire-mods/docs/using-the-api/working-with-readables/">Mod reader</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/tutorials/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocstutorials">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page  active" id="m-spotfire-modsdocstutorialsbarchart-googlechart" href="/spotfire-mods/docs/tutorials/barchart-googlechart/">Create a bar chart using Google Charts</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocstutorialsmod-icons" href="/spotfire-mods/docs/tutorials/mod-icons/">Create an icon for your visualization mod</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">












<a href="https://github.com/TIBCOSoftware/spotfire-mods//issues/new?title=Create%20a%20bar%20chart%20using%20Google%20Charts" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/TIBCOSoftware/spotfire-mods//issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>





</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#a-step-by-step-tutorial-on-using-spotfire-mods">A step-by-step tutorial on using Spotfire Mods</a>
      <ul>
        <li><a href="#dataset">Dataset</a></li>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#1-initial-setup">1. Initial setup</a></li>
        <li><a href="#2-add-google-charts-library">2. Add Google Charts library</a></li>
        <li><a href="#3-consume-spotfire-data">3. Consume Spotfire data</a></li>
        <li><a href="#4-selectionmarking">4. Selection/marking</a></li>
        <li><a href="#5-controlling-the-mod-using-the-popout">5. Controlling the mod using the popout</a></li>
        <li><a href="#6-use-spotfire-theme-and-styling">6. Use Spotfire theme and styling</a></li>
        <li><a href="#7-prepare-for-export">7. Prepare for export</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="/spotfire-mods/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="/spotfire-mods/docs/tutorials/">Tutorials</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/spotfire-mods/docs/tutorials/barchart-googlechart/">Create a bar chart using Google Charts</a>
</li>

	</ol>
</nav	>

            



<p class="-text-primary pt-3 h6" >Reading time: 11 minutes and 45 seconds.</p>
<p>
<div class="td-content">
	<h1>Create a bar chart using Google Charts</h1>
    <div class="lead">This tutorial describes how to create a basic bar chart using Google Charts and the Spotfire API.</div>
	       
	<h2 id="a-step-by-step-tutorial-on-using-spotfire-mods">A step-by-step tutorial on using Spotfire Mods</h2>
<p>We will be using <strong>Spotfire API</strong> and <a href="https://developers.google.com/chart"><strong>Google Charts</strong></a> to create a basic bar chart.</p>
<p>This tutorial will cover the following:</p>
<ul>
<li>Initial setup</li>
<li>Consuming and visualizing data</li>
<li>Selection/marking</li>
<li>Theme-ing</li>
<li>Controlling the mod using popout</li>
<li>Export to PDF</li>
</ul>
<p><strong>The full code of the result from this tutorial project (<code>'js-dev-barchart-googlecharts'</code>), as well as the starter project used in the tutorial (<code>'js-dev-starter'</code>), can be found among the <a href="http://spotfi.re/mods-examples">example projects</a>.</strong></p>
<p>The full version of the resulting example project covers some additional cases that are outside the scope of this tutorial.</p>
<h3 id="dataset">Dataset</h3>
<p>The dataset used in this tutorial can be found <a href="heroes.txt">here</a>. It is a reduced version of this <a href="https://www.kaggle.com/claudiodavi/superhero-set">dataset</a>.</p>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>A running instance of <em>Spotfire</em></li>
<li>A code editor. It is highly recommended to use Visual Studio Code when developing a mod. The mod example includes predefined settings for VS Code that enable a default build task, intellisense in the mod manifest and intellisense in the JavaScript code.</li>
<li><code>node.js</code> installed</li>
</ul>
<hr>
<h3 id="1-initial-setup">1. Initial setup</h3>
<ul>
<li>Copy the <code>js-dev-starter</code> project and rename it to something relevant, like <code>my-barchart-mod</code>. The starter project includes a minimum amount of code for a working mod.</li>
<li>Open the <em>manifest.json</em> file found in <code>src</code> folder and set the id field to <code>my-barchart-mod</code>.</li>
<li>Open the folder in a terminal or command line.</li>
<li>Run <code>npm install</code> to install dependencies.</li>
<li>Run <code>npm run server</code> to start the server. The provided server setup allows you to see live updates when developing a mod.</li>
<li>In <strong>Spotfire</strong> go to <em>Tools &gt; Development &gt; Create visualization mod</em> and <strong>connect to the project</strong> by following the on-screen steps (<em>Connect to Project &gt; Development server &gt; Connect</em>)</li>
<li>You should see some mod metadata on the screen, which means the mod is working.</li>
</ul>
<p><img src="./images/step1.PNG" alt=""></p>
<hr>
<h3 id="2-add-google-charts-library">2. Add Google Charts library</h3>
<ul>
<li>We will be using <a href="https://developers.google.com/chart/interactive/docs/gallery/barchart">this</a> google example</li>
<li>Add google chart loader script to <em>index.html</em> (<strong>before main.js script</strong>)</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">     &lt;body&gt;
         &lt;div id=&#34;mod-container&#34;&gt;&lt;/div&gt;
         &lt;script id=&#34;spotfire-loader&#34;&gt;var Spotfire=function(e){&#34;use strict&#34;;return e.initialize=function(e){var t=&#34;sfTemp&#34;+1e4*Math.random()+&#34;Cb&#34;,a=window;a[t]=e;var r={subject:&#34;GetUrl&#34;,callbackId:-1,...&lt;/script&gt;
<span style="color:#00a000">+        &lt;script type=&#34;text/javascript&#34; src=&#34;https://www.gstatic.com/charts/loader.js&#34;&gt;&lt;/script&gt;
</span><span style="color:#00a000"></span>         &lt;script src=&#34;main.js&#34;&gt;&lt;/script&gt;
     &lt;/body&gt;
 &lt;/html&gt;
</code></pre></div><ul>
<li>Add the <em>gstatic</em> domain name as an external resource in <em>mod-manifest.json</em>. External resources from unknown domains will be blocked from loading for security reasons.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">    &#34;files&#34;: [
        &#34;index.html&#34;,
        &#34;main.css&#34;,
        &#34;main.js&#34;
<span style="color:#a40000">-    ]
</span><span style="color:#a40000"></span><span style="color:#00a000">+    ],
</span><span style="color:#00a000">+    &#34;externalResources&#34;: [&#34;https://www.gstatic.com/&#34;]
</span></code></pre></div><ul>
<li>Paste full example code into <em>main.js</em> inside <strong>render</strong> function</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">     async function render(dataView, windowSize, prop) {

        /**
         * Check the data view for errors
         */
        let errors = await dataView.getErrors();
        if (errors.length &gt; 0) {
            // Showing an error overlay will hide the mod iframe.
            // Clear the mod content here to avoid flickering effect of
            // an old configuration when next valid data view is received.
            mod.controls.errorOverlay.show(errors);
            return;
        }
        mod.controls.errorOverlay.hide();

        /**
         * Get the hierarchy of the categorical X-axis.
         */
        const xHierarchy = await dataView.hierarchy(&#34;X&#34;);
        const xRoot = await xHierarchy.root();

        if (xRoot == null) {
            // User interaction caused the data view to expire.
            // Don&#39;t clear the mod content here to avoid flickering.
            return;
        }

<span style="color:#a40000">-        /**
</span><span style="color:#a40000">-         * Print out to document
</span><span style="color:#a40000">-         */
</span><span style="color:#a40000">-        const container = document.querySelector(&#34;#mod-container&#34;);
</span><span style="color:#a40000">-        container.textContent = `windowSize: ${windowSize.width}x${windowSize.height}\r\n`;
</span><span style="color:#a40000">-        container.textContent += `should render: ${rows.length} rows\r\n`;
</span><span style="color:#a40000">-        container.textContent += `${prop.name}: ${prop.value()}`;
</span><span style="color:#a40000">-
</span><span style="color:#a40000">-        /**
</span><span style="color:#a40000">-         * Signal that the mod is ready for export.
</span><span style="color:#a40000">-         */
</span><span style="color:#a40000">-        context.signalRenderComplete();
</span><span style="color:#a40000"></span>
<span style="color:#00a000">+        google.charts.load(&#34;current&#34;, { packages: [&#34;corechart&#34;] });
</span><span style="color:#00a000">+        google.charts.setOnLoadCallback(drawChart);
</span><span style="color:#00a000">+        function drawChart() {
</span><span style="color:#00a000">+            var data = google.visualization.arrayToDataTable([
</span><span style="color:#00a000">+                [&#34;Element&#34;, &#34;Density&#34;, { role: &#34;style&#34; }],
</span><span style="color:#00a000">+                [&#34;Copper&#34;, 8.94, &#34;#b87333&#34;],
</span><span style="color:#00a000">+                [&#34;Silver&#34;, 10.49, &#34;silver&#34;],
</span><span style="color:#00a000">+                [&#34;Gold&#34;, 19.3, &#34;gold&#34;],
</span><span style="color:#00a000">+                [&#34;Platinum&#34;, 21.45, &#34;color: #e5e4e2&#34;]
</span><span style="color:#00a000">+            ]);
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+            var view = new google.visualization.DataView(data);
</span><span style="color:#00a000">+            view.setColumns([0, 1, { calc: &#34;stringify&#34;, sourceColumn: 1, type: &#34;string&#34;, role: &#34;annotation&#34; }, 2]);
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+            var options = {
</span><span style="color:#00a000">+                title: &#34;Density of Precious Metals, in g/cm^3&#34;,
</span><span style="color:#00a000">+                width: 600,
</span><span style="color:#00a000">+                height: 400,
</span><span style="color:#00a000">+                bar: { groupWidth: &#34;95%&#34; },
</span><span style="color:#00a000">+                legend: { position: &#34;none&#34; },
</span><span style="color:#00a000">+            };
</span><span style="color:#00a000">+            var chart = new google.visualization.BarChart(document.getElementById(&#34;barchart_values&#34;));
</span><span style="color:#00a000">+            chart.draw(view, options);
</span><span style="color:#00a000">+        }
</span><span style="color:#00a000"></span>     }
 });
</code></pre></div><ul>
<li>Update the bar chart container id (in  <em>index.html</em>  our container id is <em>mod-container</em>)</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">
            var options = {
               title: &#34;Density of Precious Metals, in g/cm^3&#34;,
               width: 600,
               height: 400,
               bar: { groupWidth: &#34;95%&#34; },
               legend: { position: &#34;none&#34; },
           };
<span style="color:#a40000">-            var chart = new google.visualization.BarChart(document.getElementById(&#34;barchart_values&#34;));
</span><span style="color:#a40000"></span><span style="color:#00a000">+            var chart = new google.visualization.BarChart(document.getElementById(&#34;mod-container&#34;));
</span><span style="color:#00a000"></span>            chart.draw(view, options);
</code></pre></div><ul>
<li>Save the changes. You should see the example working in Spotfire.</li>
</ul>
<p><img src="./images/step2.PNG" alt=""></p>
<ul>
<li>Make use of <em>async/await</em> to get rid of extra code.</li>
<li>Make the chart fit the screen by providing a chart area with some predefined margins.</li>
<li>Get rid of chart title.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#a40000">-       google.charts.load(&#34;current&#34;, { packages: [&#34;corechart&#34;] });
</span><span style="color:#a40000">-       google.charts.setOnLoadCallback(drawChart);
</span><span style="color:#a40000"></span>
<span style="color:#a40000">-       function drawChart() {
</span><span style="color:#a40000"></span><span style="color:#00a000">+       await google.charts.load(&#34;current&#34;, { packages: [&#34;corechart&#34;] });
</span><span style="color:#00a000"></span>          var data = google.visualization.arrayToDataTable([
              [&#34;Element&#34;, &#34;Density&#34;, { role: &#34;style&#34; }],
              [&#34;Copper&#34;, 8.94, &#34;#b87333&#34;],
              [&#34;Silver&#34;, 10.49, &#34;silver&#34;],
              [&#34;Gold&#34;, 19.3, &#34;gold&#34;],
              [&#34;Platinum&#34;, 21.45, &#34;color: #e5e4e2&#34;]
          ]);

          var view = new google.visualization.DataView(data);
          view.setColumns([0, 1, { calc: &#34;stringify&#34;, sourceColumn: 1, type: &#34;string&#34;, role: &#34;annotation&#34; }, 2]);

          var options = {
<span style="color:#a40000">-             title: &#34;Density of Precious Metals, in g/cm^3&#34;,
</span><span style="color:#a40000">-             width: 600,
</span><span style="color:#a40000">-             height: 400,
</span><span style="color:#a40000"></span>              bar: { groupWidth: &#34;95%&#34; },
              legend: { position: &#34;none&#34; },
<span style="color:#00a000">+             chartArea: { left: 85, top: 20, right: 10, bottom: 40 }
</span><span style="color:#00a000"></span>          };
          var chart = new google.visualization.BarChart(document.getElementById(&#34;mod-container&#34;));
          chart.draw(view, options);
        }
<span style="color:#a40000">-     }
</span></code></pre></div><hr>
<h3 id="3-consume-spotfire-data">3. Consume Spotfire data</h3>
<ul>
<li>We create hierarchies for X and Color dimensions. These are defined in the manifest and should not be confused with actual color values (<strong>css-color</strong> from now on to avoid confusion).</li>
<li>We then use this grouped data to extract column names, values and css-colors.</li>
<li>A google visualization expects data to be in the following format (and complains if it&rsquo;s not):</li>
</ul>
<table>
<thead>
<tr>
<th>SeriesNames</th>
<th>Series1</th>
<th>Style</th>
<th>Series2</th>
<th>Style</th>
<th>Series3</th>
<th>Style</th>
</tr>
</thead>
<tbody>
<tr>
<td>Category1</td>
<td>Value11</td>
<td>CssColor11</td>
<td>Value12</td>
<td>CssColor12</td>
<td>Value13</td>
<td>CssColor13</td>
</tr>
<tr>
<td>Category2</td>
<td>Value21</td>
<td>CssColor21</td>
<td>Value22</td>
<td>CssColor22</td>
<td>Value23</td>
<td>CssColor23</td>
</tr>
</tbody>
</table>
<ul>
<li>We loop over X hierarchy to create the data table by filling a row with null values first, and then populating it with existing values at proper positions.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#a40000">-        var data = google.visualization.arrayToDataTable([
</span><span style="color:#a40000">-            [&#34;Element&#34;, &#34;Density&#34;, { role: &#34;style&#34; }],
</span><span style="color:#a40000">-            [&#34;Copper&#34;, 8.94, &#34;#b87333&#34;],
</span><span style="color:#a40000">-            [&#34;Silver&#34;, 10.49, &#34;silver&#34;],
</span><span style="color:#a40000">-            [&#34;Gold&#34;, 19.3, &#34;gold&#34;],
</span><span style="color:#a40000">-            [&#34;Platinum&#34;, 21.45, &#34;color: #e5e4e2&#34;]
</span><span style="color:#a40000">-        ]);
</span><span style="color:#a40000"></span>
<span style="color:#a40000">-        var view = new google.visualization.DataView(data);
</span><span style="color:#a40000">-        view.setColumns([0, 1, { calc: &#34;stringify&#34;, sourceColumn: 1, type: &#34;string&#34;, role: &#34;annotation&#34; }, 2]);
</span><span style="color:#a40000"></span>
<span style="color:#00a000">+        const colorHierarchy = await dataView.hierarchy(&#34;Color&#34;);
</span><span style="color:#00a000">+        const colorLeafNodes = (await colorHierarchy.root()).leaves();
</span><span style="color:#00a000">+        const colorDomain = colorHierarchy.isEmpty ? [&#34;All Values&#34;] : colorLeafNodes.map((node) =&gt; node.formattedPath());
</span><span style="color:#00a000"></span>
<span style="color:#00a000">+        const xLeafNodes = (await xHierarchy.root()).leaves();
</span><span style="color:#00a000">+        const xDomain = xLeafNodes.map(node =&gt; node.formattedValue());
</span><span style="color:#00a000"></span>
<span style="color:#00a000">+        const dataColumns = [&#34;Columns&#34;];
</span><span style="color:#00a000">+        colorDomain.forEach(value =&gt; dataColumns.push(value, { role: &#34;style&#34; }));
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+        const dataRows = [];
</span><span style="color:#00a000">+        xLeafNodes.forEach(
</span><span style="color:#00a000">+            (node) =&gt; {
</span><span style="color:#00a000">+               let valueAndColorPairs = new Array(colorLeafNodes.length).fill([0, &#34;&#34;]).flat()
</span><span style="color:#00a000">+               node.rows().forEach((r) =&gt; {
</span><span style="color:#00a000">+                   let colorIndex = !colorHierarchy.isEmpty ? r.categorical(&#34;Color&#34;).leafIndex : 0;
</span><span style="color:#00a000">+                   let yValue = r.continuous(&#34;Y&#34;).value();
</span><span style="color:#00a000">+                   valueAndColorPairs[colorIndex * 2] = yValue;
</span><span style="color:#00a000">+                   valueAndColorPairs[colorIndex * 2 + 1] = r.color().hexCode;
</span><span style="color:#00a000">+               });
</span><span style="color:#00a000">+               const dataRow = [node.formattedPath(), valueAndColorPairs].flat();
</span><span style="color:#00a000">+               dataRows.push(dataRow)
</span><span style="color:#00a000">+            }
</span><span style="color:#00a000">+        );
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+        var data = google.visualization.arrayToDataTable([dataColumns, ...dataRows]);
</span><span style="color:#00a000"></span>
         var options = {
             bar: { groupWidth: &#34;95%&#34; },
             legend: { position: &#34;none&#34; },
             chartArea: { left: 85, top: 20, right: 10, bottom: 40 }
         };
         var chart = new google.visualization.BarChart(document.getElementById(&#34;mod-container&#34;));
<span style="color:#a40000">-        chart.draw(view, options);
</span><span style="color:#a40000"></span><span style="color:#00a000">+        chart.draw(data, options);
</span></code></pre></div><ul>
<li>Not all combinations of <em>X</em> and <em>Color</em> domains will be renderable by google charts out of the box, without special treatment. We will guard against this with a <strong>try/catch</strong> block.</li>
<li>The full code of the <code>js-dev-barchart-googlecharts</code> example project goes a little bit more in depth than this tutorial and covers some additional cases</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#a40000">-        var data = google.visualization.arrayToDataTable([dataColumns, ...dataRows]);
</span><span style="color:#a40000"></span><span style="color:#00a000">+        let data;
</span><span style="color:#00a000">+        try {
</span><span style="color:#00a000">+            data = google.visualization.arrayToDataTable([dataColumns, ...dataRows]);
</span><span style="color:#00a000">+        } catch (e) {
</span><span style="color:#00a000">+            console.log(e);
</span><span style="color:#00a000">+        }
</span></code></pre></div><p><img src="./images/step3.PNG" alt=""></p>
<hr>
<h3 id="4-selectionmarking">4. Selection/marking</h3>
<ul>
<li>Add selection/marking logic. We listen for &ldquo;<em>select</em>&rdquo; event and extract X and Color values (<em>not css-color!</em>) by index in their respective domains. The Color index is halved because we have 2 times as many columns due to styling being applied (see table above).</li>
<li>The rows (in this case there will be only one row) to mark will be in the intersection of the set of rows for the marked color and the set of rows for the marked x value. An obvious optimization would be to store the rows as a hash map to eliminate redundancy.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">
         var chart = new google.visualization.BarChart(document.getElementById(&#34;mod-container&#34;));
         chart.draw(data, options);

<span style="color:#00a000">+        google.visualization.events.addListener(chart, &#34;select&#34;, () =&gt; {
</span><span style="color:#00a000">+            const selection = chart.getSelection()[0];
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+            if (!selection) return;
</span><span style="color:#00a000">+            const { row, column } = selection;
</span><span style="color:#00a000">+            const xIndex = row;
</span><span style="color:#00a000">+            const colorIndex = (column - 1) / 2;
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+            intersection(xLeafNodes[xIndex].rows(), colorLeafNodes[colorIndex].rows()).forEach((r) =&gt; r.mark());
</span><span style="color:#00a000">+       });
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+        function intersection(rows1, rows2) {
</span><span style="color:#00a000">+            return rows1.filter((r) =&gt; rows2.indexOf(r) &gt; -1);
</span><span style="color:#00a000">+        }
</span><span style="color:#00a000"></span>     }

</code></pre></div><p><img src="./images/step4.PNG" alt=""></p>
<ul>
<li>To clear all marking on background click, as native Spotfire visualizations do, we listen for &ldquo;click&rdquo; event and check its target id.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">        function intersection(rows1, rows2) {
            return rows1.filter((r) =&gt; rows2.indexOf(r) &gt; -1);
<span style="color:#00a000">+
</span><span style="color:#00a000">+        google.visualization.events.addListener(chart, &#34;click&#34;, ({ targetID, x, y }) =&gt; {
</span><span style="color:#00a000">+            if (targetID == &#34;chartarea&#34;) {
</span><span style="color:#00a000">+                dataView.clearMarking();
</span><span style="color:#00a000">+                return;
</span><span style="color:#00a000">+            }
</span><span style="color:#00a000">+        });
</span><span style="color:#00a000"></span>     }
 });
</code></pre></div><hr>
<h3 id="5-controlling-the-mod-using-the-popout">5. Controlling the mod using the popout</h3>
<ul>
<li>We would like to control the chart&rsquo;s <em>orientation (horizontal/vertical)</em> and <em>stacking (side-by-side/stacked)</em>. The mods api allows us to do this via a popout menu.</li>
<li>First, we add them as properties to the manifest.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">     &#34;icon&#34;: &#34;icon.svg&#34;,
     &#34;properties&#34;: [
         {
<span style="color:#a40000">-            &#34;name&#34;: &#34;myProperty&#34;,
</span><span style="color:#a40000"></span><span style="color:#00a000">+            &#34;name&#34;: &#34;orientation&#34;,
</span><span style="color:#00a000"></span>             &#34;type&#34;: &#34;string&#34;,
<span style="color:#a40000">-            &#34;defaultValue&#34;: &#34;myValue&#34;
</span><span style="color:#a40000"></span><span style="color:#00a000">+            &#34;defaultValue&#34;: &#34;vertical&#34;
</span><span style="color:#00a000">+        },
</span><span style="color:#00a000">+        {
</span><span style="color:#00a000">+            &#34;name&#34;: &#34;stacking&#34;,
</span><span style="color:#00a000">+            &#34;type&#34;: &#34;string&#34;,
</span><span style="color:#00a000">+            &#34;defaultValue&#34;: &#34;side-by-side&#34;
</span><span style="color:#00a000"></span>         }
     ],
</code></pre></div><ul>
<li>
<p>Then we add the new properties to the read loop and pass them down to the render function.</p>
</li>
<li>
<p><strong>Since the manifest has changed, we will need to reconnect the development server to Spotfire for the changes to take effect</strong> (<em>&ldquo;Properties&rdquo; icon (<code>puzzle piece</code>) in the upper right of the mod screen &gt; Disconnect</em> &gt; <em>Connect</em>)</p>
</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">    /**
     * Create the read function.
     */
<span style="color:#a40000">-    const reader = mod.createReader(mod.visualization.data(), mod.windowSize(), mod.property(&#34;myProperty&#34;));
</span><span style="color:#a40000"></span><span style="color:#00a000">+    const reader = mod.createReader(
</span><span style="color:#00a000">+        mod.visualization.data(),
</span><span style="color:#00a000">+        mod.windowSize(),
</span><span style="color:#00a000">+        mod.property(&#34;orientation&#34;),
</span><span style="color:#00a000">+        mod.property(&#34;stacking&#34;)
</span><span style="color:#00a000">+    );
</span><span style="color:#00a000"></span>
    /**
     * Initiate the read loop
     */
    reader.subscribe(render);

     /**
      * @param {Spotfire.DataView} dataView
      * @param {Spotfire.Size} windowSize
<span style="color:#a40000">-     * @param {Spotfire.ModProperty&lt;string&gt;} prop
</span><span style="color:#a40000"></span><span style="color:#00a000">+     * @param {Spotfire.ModProperty&lt;string&gt;} orientation
</span><span style="color:#00a000">+     * @param {Spotfire.ModProperty&lt;string&gt;} stacking
</span><span style="color:#00a000"></span>      */
<span style="color:#a40000">-    async function render(dataView, windowSize, prop) {
</span><span style="color:#a40000"></span><span style="color:#00a000">+    async function render(dataView, windowSize, orientation, stacking) {
</span></code></pre></div><ul>
<li>Update the background click callback to show a test popout.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">         google.visualization.events.addListener(chart, &#34;click&#34;, ({ targetID, x, y }) =&gt; {
             if (targetID == &#34;chartarea&#34;) {
                 dataView.clearMarking();
<span style="color:#00a000">+                showPopout({ x, y });
</span><span style="color:#00a000"></span>                 return;
             }
         });

<span style="color:#00a000">+        const { popout } = mod.controls;
</span><span style="color:#00a000">+        function showPopout(e) {
</span><span style="color:#00a000">+            popout.show(
</span><span style="color:#00a000">+                {
</span><span style="color:#00a000">+                    x: e.x,
</span><span style="color:#00a000">+                    y: e.y,
</span><span style="color:#00a000">+                    autoClose: true,
</span><span style="color:#00a000">+                    alignment: &#34;Bottom&#34;,
</span><span style="color:#00a000">+                    onChange: popoutChangeHandler
</span><span style="color:#00a000">+                },
</span><span style="color:#00a000">+                popoutContent
</span><span style="color:#00a000">+            );
</span><span style="color:#00a000">+        }
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+        const { section } = popout;
</span><span style="color:#00a000">+        const { button } = popout.components;
</span><span style="color:#00a000">+        const popoutContent = () =&gt; [
</span><span style="color:#00a000">+           section({ heading: &#34;I&#39;m a popout!&#34;, children: [button({ text: &#34;I&#39;m a button&#34;, name: &#34;button&#34; })] })
</span><span style="color:#00a000">+        ];
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+        function popoutChangeHandler() {}
</span><span style="color:#00a000"></span>     }
 });
</code></pre></div><p><img src="./images/step5.PNG" alt=""></p>
<ul>
<li>Add a tiny helper function to check property value.</li>
<li>On each render we check <strong>stacking</strong> and <strong>orientation</strong> properties and update the chart configuration accordingly. Stacking is a simple boolean but orientation requires different classes for horizontal and vertical types of charts.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#00a000">+        const is = property =&gt; value =&gt; property.value() == value;
</span><span style="color:#00a000">+
</span><span style="color:#00a000"></span>         var options = {
             bar: { groupWidth: &#34;95%&#34; },
             legend: { position: &#34;none&#34; },
<span style="color:#a40000">-            chartArea: { left: 85, top: 20, right: 10, bottom: 40 }
</span><span style="color:#a40000"></span><span style="color:#00a000">+            chartArea: { left: 85, top: 20, right: 10, bottom: 40 },
</span><span style="color:#00a000">+            isStacked: is(stacking)(&#34;stacked&#34;)
</span><span style="color:#00a000"></span>         };

<span style="color:#a40000">-        var chart = new google.visualization.BarChart(document.getElementById(&#34;mod-container&#34;));
</span><span style="color:#a40000"></span><span style="color:#00a000">+
</span><span style="color:#00a000">+        const container = document.querySelector(&#34;#mod-container&#34;);
</span><span style="color:#00a000">+        let chart;
</span><span style="color:#00a000">+        if (is(orientation)(&#34;horizontal&#34;)) {
</span><span style="color:#00a000">+            chart = new google.visualization.BarChart(container);
</span><span style="color:#00a000">+        } else {
</span><span style="color:#00a000">+            chart = new google.visualization.ColumnChart(container);
</span><span style="color:#00a000">+        }
</span><span style="color:#00a000">+
</span><span style="color:#00a000"></span>         chart.draw(data, options);
</code></pre></div><ul>
<li>To mimic native Spotfire bar chart behavior, we show a popout on X-axis click (Y-axis for horizontal orientation).</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">         google.visualization.events.addListener(chart, &#34;click&#34;, ({ targetID, x, y }) =&gt; {
             if (targetID == &#34;chartarea&#34;) {
                 dataView.clearMarking();
<span style="color:#a40000">-                showPopout({ x, y });
</span><span style="color:#a40000"></span>                 return;
             }
<span style="color:#00a000">+
</span><span style="color:#00a000">+            if (is(orientation)(&#34;vertical&#34;) &amp;&amp; targetID.indexOf(&#34;hAxis&#34;) != -1) {
</span><span style="color:#00a000">+                showPopout({ x, y });
</span><span style="color:#00a000">+                return;
</span><span style="color:#00a000">+            }
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+            if (is(orientation)(&#34;horizontal&#34;) &amp;&amp; targetID.indexOf(&#34;vAxis&#34;) != -1) {
</span><span style="color:#00a000">+                showPopout({ x, y });
</span><span style="color:#00a000">+                return;
</span><span style="color:#00a000">+            }
</span><span style="color:#00a000"></span>         });
</code></pre></div><ul>
<li>Create popout content from the available components.</li>
<li>Listen for popout changes and update property values. This will trigger a re-render and add an undoable step to the native <em>Undo stack</em>.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">         const { section } = popout;
<span style="color:#a40000">-        const { button } = popout.components;
</span><span style="color:#a40000">-        const popoutContent = () =&gt; [
</span><span style="color:#a40000">-           section({ heading: &#34;I&#39;m a popout!&#34;, children: [button({ text: &#34;I&#39;m a button&#34;, name: &#34;button&#34; })] })
</span><span style="color:#a40000">-        ];
</span><span style="color:#a40000"></span>
<span style="color:#00a000">+        const { radioButton } = popout.components;
</span><span style="color:#00a000">+        const popoutContent = () =&gt; [
</span><span style="color:#00a000">+            section({
</span><span style="color:#00a000">+                heading: &#34;Chart Type&#34;,
</span><span style="color:#00a000">+                children: [
</span><span style="color:#00a000">+                    radioButton({
</span><span style="color:#00a000">+                        name: stacking.name,
</span><span style="color:#00a000">+                        text: &#34;Stacked bars&#34;,
</span><span style="color:#00a000">+                        value: &#34;stacked&#34;,
</span><span style="color:#00a000">+                        checked: is(stacking)(&#34;stacked&#34;)
</span><span style="color:#00a000">+                    }),
</span><span style="color:#00a000">+                    radioButton({
</span><span style="color:#00a000">+                        name: stacking.name,
</span><span style="color:#00a000">+                        text: &#34;Side-by-side bars&#34;,
</span><span style="color:#00a000">+                        value: &#34;side-by-side&#34;,
</span><span style="color:#00a000">+                        checked: is(stacking)(&#34;side-by-side&#34;)
</span><span style="color:#00a000">+                    })
</span><span style="color:#00a000">+                ]
</span><span style="color:#00a000">+            }),
</span><span style="color:#00a000">+            section({
</span><span style="color:#00a000">+                heading: &#34;Orientation&#34;,
</span><span style="color:#00a000">+                children: [
</span><span style="color:#00a000">+                    radioButton({
</span><span style="color:#00a000">+                        name: orientation.name,
</span><span style="color:#00a000">+                        text: &#34;Vertical&#34;,
</span><span style="color:#00a000">+                        value: &#34;vertical&#34;,
</span><span style="color:#00a000">+                        checked: is(orientation)(&#34;vertical&#34;)
</span><span style="color:#00a000">+                    }),
</span><span style="color:#00a000">+                    radioButton({
</span><span style="color:#00a000">+                        name: orientation.name,
</span><span style="color:#00a000">+                        text: &#34;Horizontal&#34;,
</span><span style="color:#00a000">+                        value: &#34;horizontal&#34;,
</span><span style="color:#00a000">+                        checked: is(orientation)(&#34;horizontal&#34;)
</span><span style="color:#00a000">+                    })
</span><span style="color:#00a000">+                ]
</span><span style="color:#00a000">+            })
</span><span style="color:#00a000">+        ];
</span><span style="color:#00a000"></span>

<span style="color:#a40000">-        function popoutChangeHandler() {}
</span><span style="color:#a40000"></span><span style="color:#00a000">+        function popoutChangeHandler({ name, value }) {
</span><span style="color:#00a000">+            name == orientation.name &amp;&amp; orientation.set(value);
</span><span style="color:#00a000">+            name == stacking.name &amp;&amp; stacking.set(value);
</span><span style="color:#00a000">+        }
</span><span style="color:#00a000"></span>
</code></pre></div><ul>
<li>Lastly, add a pointer cursor to <code>svg text</code> rule in <em>main.css</em> to signal an interactive element.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">html, body, #mod-container {
     margin: 0;
     height: 100%;
     overflow: hidden;
}
<span style="color:#00a000">+
</span><span style="color:#00a000">+svg text {
</span><span style="color:#00a000">+    cursor: pointer;
</span><span style="color:#00a000">+}
</span></code></pre></div><p><img src="./images/step5-1.PNG" alt=""></p>
<hr>
<h3 id="6-use-spotfire-theme-and-styling">6. Use Spotfire theme and styling</h3>
<ul>
<li>Extract style info from context</li>
<li>Update Options object</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">
<span style="color:#00a000">+        const context = mod.getRenderContext();
</span><span style="color:#00a000">+        const styling = context.styling;
</span><span style="color:#00a000">+        const textStyle = {
</span><span style="color:#00a000">+            fontSize: styling.scales.font.fontSize,
</span><span style="color:#00a000">+            fontName: styling.scales.font.fontFamily,
</span><span style="color:#00a000">+            color: styling.scales.font.color
</span><span style="color:#00a000">+        };
</span><span style="color:#00a000">+
</span><span style="color:#00a000">+        const baselineColor = styling.scales.line.stroke;
</span><span style="color:#00a000">+        const gridlines = { color: &#34;transparent&#34; };
</span><span style="color:#00a000"></span>
<span style="color:#a40000">-        var options = {
</span><span style="color:#a40000">-            bar: { groupWidth: &#34;95%&#34; },
</span><span style="color:#a40000"></span><span style="color:#00a000">+        const options = {
</span><span style="color:#00a000">+            bar: { groupWidth: &#34;80%&#34; },
</span><span style="color:#00a000">+            backgroundColor: { fill: &#34;transparent&#34; },
</span><span style="color:#00a000"></span>             legend: { position: &#34;none&#34; },
             chartArea: { left: 85, top: 20, right: 10, bottom: 40 },
<span style="color:#a40000">-            isStacked: is(stacking)(&#34;stacked&#34;)
</span><span style="color:#a40000"></span><span style="color:#00a000">+            isStacked: is(stacking)(&#34;stacked&#34;),
</span><span style="color:#00a000">+            hAxis: {
</span><span style="color:#00a000">+                textStyle,
</span><span style="color:#00a000">+                baselineColor,
</span><span style="color:#00a000">+                gridlines
</span><span style="color:#00a000">+            },
</span><span style="color:#00a000">+            vAxis: {
</span><span style="color:#00a000">+                textStyle,
</span><span style="color:#00a000">+                baselineColor,
</span><span style="color:#00a000">+                gridlines,
</span><span style="color:#00a000">+                minValue: 0
</span><span style="color:#00a000">+            }
</span><span style="color:#00a000"></span>         };
</code></pre></div><ul>
<li>In Spotfire, change <em>Visualizations Theme</em> to <strong>Dark</strong> (<em>Visualizations &gt; Canvas styling &gt; Dark</em>). You should see colors change according to theme.</li>
</ul>
<p><img src="./images/step6.PNG" alt=""></p>
<hr>
<h3 id="7-prepare-for-export">7. Prepare for export</h3>
<ul>
<li>For export to work, we need to let Spotfire know when rendering is complete.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff">        function popoutChangeHandler({ name, value }) {
            name == orientation.name &amp;&amp; orientation.set(value);
            name == stacking.name &amp;&amp; stacking.set(value);
        }

<span style="color:#00a000">+       google.visualization.events.addListener(chart, &#34;ready&#34;, () =&gt; context.signalRenderComplete());
</span></code></pre></div><ul>
<li>Go to <em>File &gt; Export &gt; Visualization to PDF</em> to test the export feature</li>
</ul>
<p><img src="./images/step7.PNG" alt=""></p>
<ul>
<li>Note that this example Mod is using external resources, hence it will not be possible to export using the web client, see the <a href="https://tibcosoftware.github.io/spotfire-mods/docs/using-the-api/mod-schema/">manifest schema documentation</a>.</li>
</ul>

	
		<style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<div class="d-print-none">
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it! Please <a href="https://github.com/TIBCOSoftware/spotfire-mods/issues/new">tell us how we can improve</a>.
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that. Please <a href="https://github.com/TIBCOSoftware/spotfire-mods/issues/new">tell us how we can improve</a>.
</p>
</div>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

		<br />
	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified November 6, 2020
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-4 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Facebook" aria-label="Facebook">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/TIBCO">
      <i class="fab fa-facebook"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://twitter.com/tibco">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Linkedin" aria-label="Linkedin">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/tibco/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/TIBCOSoftware/spotfire-mods/">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="TIBCO Community" aria-label="TIBCO Community">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://community.tibco.com/wiki/">
      <i class="fa fa-comment-alt"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 TIBCO Software Inc. All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.tibco.com/company/terms-of-use" target="_blank">Privacy Policy</a></small>
	
		<p class="mt-2"><a href="/spotfire-mods/about/">About Spotfire Mods</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/spotfire-mods/js/main.min.fc448b19813d4fadb2cca28987d991692426ee27f66ce87690830854284c14ec.js" data-integrity="sha256-/ESLGYE9T62yzKKJh9mRaSQm7if2bOh2kIMIVChMFOw=" crossorigin="anonymous"></script>




  </body>
</html>